- name: Create Cluster
  docker_container:
    name: redis-cluster
    image: redis:latest
    state: started
    ports:
    - "6379:6379"
    command: [ "sh", "-c", "echo 'yes' | redis-cli --cluster create {{ node1_hostname }}:{{ redis_1_port }} {{ node1_hostname }}:{{ redis_2_port }} {{ node2_hostname }}:{{ redis_1_port }} {{ node2_hostname }}:{{ redis_2_port }} {{ node3_hostname }}:{{ redis_1_port }} {{ node3_hostname }}:{{ redis_2_port }}" ]
  when: inventory_hostname == node1_hostname
